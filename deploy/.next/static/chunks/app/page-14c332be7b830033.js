(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{63:(e,s,t)=>{"use strict";var n=t(7260);t.o(n,"useRouter")&&t.d(s,{useRouter:function(){return n.useRouter}}),t.o(n,"useSearchParams")&&t.d(s,{useSearchParams:function(){return n.useSearchParams}})},7432:(e,s,t)=>{Promise.resolve().then(t.bind(t,9547))},9547:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>c});var n=t(5155),r=t(2115),a=t(63);function l(){let e=(0,a.useRouter)(),s=(0,a.useSearchParams)(),[t,l]=(0,r.useState)(!1),[c,u]=(0,r.useState)(!1),o=(0,r.useRef)(!1);(0,r.useEffect)(()=>{let e=null==s?void 0:s.get("tok"),n=null==s?void 0:s.get("clientip");if(e&&n&&!t){l(!0);let s="".concat(window.location.origin,"/?auto=1"),t="http://192.168.1.1:2050/opennds_preauth/?clientip=".concat(encodeURIComponent(n),"&tok=").concat(encodeURIComponent(e),"&redir=").concat(encodeURIComponent(s));window.location.href=t;return}},[s,t,e]);let i=(0,r.useCallback)(async()=>{u(!0),console.log("[UI][enqueue] POST /api/queue/enqueue ...");try{let s=await fetch("/api/queue/enqueue",{method:"POST"});if(s.ok){let{ticketId:t,reused:n}=await s.json();console.log("[UI][enqueue] success",{ticketId:t,reused:n}),console.log("[UI][enqueue] navigate /queue?ticketId=".concat(t)),e.push("/queue?ticketId=".concat(t))}else console.error("[UI][enqueue] error status=",s.status),console.error("Erreur lors de l'entr\xe9e dans la file"),alert("Erreur lors de l'entr\xe9e dans la file. Veuillez r\xe9essayer.")}catch(e){console.error("[UI][enqueue] network error:",e),alert("Erreur de connexion. Veuillez r\xe9essayer.")}finally{u(!1)}},[e]);return((0,r.useEffect)(()=>{(null==s?void 0:s.get("auto"))&&!o.current&&!c&&(o.current=!0,i())},[s,c,i]),t)?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center p-8",children:(0,n.jsx)("div",{className:"text-xl text-gray-600",children:"Connexion au r\xe9seau WiFi en cours..."})}):(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center p-8",children:(0,n.jsxs)("div",{className:"max-w-md w-full",children:[(0,n.jsxs)("div",{className:"text-center mb-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Tests Techno 130 ans EMF"}),(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:"Bienvenue dans le syst\xe8me de questions techniques pour c\xe9l\xe9brer les 130 ans de l'\xc9cole des M\xe9tiers de Fribourg."}),(0,n.jsx)("p",{className:"text-sm text-gray-500 mb-8",children:"Le syst\xe8me garantit l'acc\xe8s exclusif aux questions - une seule personne \xe0 la fois peut participer."})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("button",{onClick:i,disabled:c,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors text-lg font-medium",children:c?"Entr\xe9e en cours...":"Entrer dans la file d'attente"}),(0,n.jsx)("div",{className:"text-xs text-gray-400 text-center",children:"Version TEST - Questions via JSON local, simulation d'affichage uniquement"})]})]})})}function c(){return(0,n.jsx)(r.Suspense,{fallback:(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center p-8",children:(0,n.jsx)("div",{className:"text-xl text-gray-600",children:"Chargementâ€¦"})}),children:(0,n.jsx)(l,{})})}}},e=>{e.O(0,[441,255,358],()=>e(e.s=7432)),_N_E=e.O()}]);