"use strict";(()=>{var e={};e.id=75,e.ids=[75],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9878:(e,t,o)=>{o.r(t),o.d(t,{originalPathname:()=>h,patchFetch:()=>D,requestAsyncStorage:()=>L,routeModule:()=>d,serverHooks:()=>E,staticGenerationAsyncStorage:()=>S});var n={};o.r(n),o.d(n,{GET:()=>u,POST:()=>g,runtime:()=>p});var r=o(9303),s=o(8716),a=o(670),i=o(7070),l=o(1748),c=o(3676);let p="nodejs";async function u(){console.log("[TEST-ESP32] Testing connectivity...");let e=await (0,l.K)();return i.NextResponse.json({timestamp:new Date().toISOString(),wled:{configured:!!process.env.WLED_URL||!0,url:process.env.WLED_URL||"http://192.168.2.120/json/state",reachable:e},display:{configured:!!process.env.NUMBER_DISPLAY_URL||!0,url:process.env.NUMBER_DISPLAY_URL||"http://192.168.2.130/data",tokenConfigured:!!process.env.NUMBER_DISPLAY_TOKEN}})}async function g(e){let t=await e.json().catch(()=>({})),o={};if(void 0!==t.wled){let e=String(t.wled||"TEST");console.log("[TEST-ESP32] Sending to WLED:",e);let n=await (0,l.z)(e);o.wled={sent:n,text:e}}if(void 0!==t.display){let e=Number(t.display)||0;console.log("[TEST-ESP32] Sending to display:",e);let n=await (0,c.c)(e);o.display={sent:n,id:e}}return i.NextResponse.json({timestamp:new Date().toISOString(),results:o})}let d=new r.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/test-esp32/route",pathname:"/api/test-esp32",filename:"route",bundlePath:"app/api/test-esp32/route"},resolvedPagePath:"D:\\tests techno 130 ans EMF\\src\\app\\api\\test-esp32\\route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:L,staticGenerationAsyncStorage:S,serverHooks:E}=d,h="/api/test-esp32/route";function D(){return(0,a.patchFetch)({serverHooks:E,staticGenerationAsyncStorage:S})}},3676:(e,t,o)=>{o.d(t,{c:()=>s});let n=process.env.NUMBER_DISPLAY_URL||"http://192.168.2.130/data",r=process.env.NUMBER_DISPLAY_TOKEN||"";async function s(e){if(!n)return console.warn("[NUM-DISPLAY] ⚠️ No URL configured, SKIPPING"),!1;if(!r)return console.warn("[NUM-DISPLAY] ⚠️ No token configured (NUMBER_DISPLAY_TOKEN env var), SKIPPING"),!1;let t=Math.max(0,Math.min(255,Number.isFinite(e)?Math.trunc(e):255)),o=`token=${encodeURIComponent(r)}&datain=${t}`;console.log("[NUM-DISPLAY] Sending request:",{url:n,id:t,bodyLength:o.length});try{let e=await fetch(n,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:o,signal:AbortSignal.timeout(3e3)}),t=await e.text().catch(()=>"");if(!e.ok)return console.error("[NUM-DISPLAY] ❌ HTTP Error:",e.status,t),!1;return console.log("[NUM-DISPLAY] ✓ Response OK:",e.status,t),!0}catch(e){return console.error("[NUM-DISPLAY] ❌ Network error:",e),!1}}console.log("[NUM-DISPLAY] ═══════════════════════════════════════════"),console.log("[NUM-DISPLAY] Configuration:"),console.log("[NUM-DISPLAY]   URL:",n),console.log("[NUM-DISPLAY]   Token configured:",r?"YES ("+r.length+" chars)":"NO ⚠️"),console.log("[NUM-DISPLAY] ═══════════════════════════════════════════")},1748:(e,t,o)=>{o.d(t,{K:()=>s,z:()=>r});let n=process.env.WLED_URL||"http://192.168.2.120/json/state";async function r(e){if(!n)return console.warn("[WLED] ⚠️ No URL configured, SKIPPING"),!1;let t=e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toUpperCase(),o=t.length>64?`${t.slice(0,61).trimEnd()}...`:t;console.log("[WLED] Sending text:",{url:n,text:o,textLength:o.length});try{let e=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({on:!0,bri:255,mainseg:0,seg:[{id:0,start:0,stop:32,startY:0,stopY:8,grp:1,spc:0,of:0,on:!0,frz:!1,bri:255,cct:127,set:0,n:o,col:[[77,166,255],[0,0,0],[0,0,0]],fx:122,sx:200,ix:128,pal:0,c1:0,c2:128,c3:16,sel:!0,rev:!1,mi:!1,rY:!1,mY:!1,tp:!1,o1:!1,o2:!1,o3:!1,si:0,m12:0}]}),signal:AbortSignal.timeout(5e3)}),t=await e.text().catch(()=>"");if(!e.ok)return console.error("[WLED] ❌ HTTP Error:",e.status,t.substring(0,200)),!1;if(console.log("[WLED] ✓ Response OK:",e.status),t)try{let e=JSON.parse(t);console.log("[WLED] Response state:",{on:e.on,bri:e.bri,seg0_n:e.seg?.[0]?.n?.substring(0,30)})}catch{console.log("[WLED] Response (raw):",t.substring(0,100))}return!0}catch(e){return console.error("[WLED] ❌ Network error:",e),!1}}async function s(){let e=n?.replace("/json/state","/json/info");if(!e)return!1;try{let t=await fetch(e,{method:"GET",signal:AbortSignal.timeout(3e3)});if(t.ok){let e=await t.json();return console.log("[WLED] Connection test OK:",{name:e.name,ver:e.ver,ip:e.ip}),!0}return!1}catch{return console.error("[WLED] Connection test FAILED"),!1}}console.log("[WLED] ═══════════════════════════════════════════"),console.log("[WLED] Configuration:"),console.log("[WLED]   URL:",n),console.log("[WLED] ═══════════════════════════════════════════")}};var t=require("../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),n=t.X(0,[276,972],()=>o(9878));module.exports=n})();